<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8"/>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <title>后台管理系统</title>
    <link rel="stylesheet" href="/assets/vendor/layui/css/layui.css"/>
    <link rel="stylesheet" href="/assets/model/common/css/style.css"/>
    <link rel="stylesheet" href="/assets/model/common/css/common.css"/>
    <script type="text/javascript" src="/assets/vendor/layui/layui.js"></script>
    <!--[if lt IE 9]>
    <script src="/assets/model/common/js/html5shiv.min.js"></script>
    <script src="/assets/model/common/js/respond.min.js"></script>
    <![endif]-->
    <style>
        .layui-col-space15 {
            /* margin: -7.5px; */
            margin:-7.5px 0 !important;
        }
    </style>
</head>
<style type="text/css">
    html {
        background-color: #fff;
    }
    .work-sheet-log-content{
        font-size: 15px;font-weight: bold;
    }
    .work-sheet-log-content-color-blue{
        color: #1E9FFF;
    }
    .work-sheet-module-ul{
        width: 100%;display: flex;justify-content: center;align-items: center;
    }
    .work-sheet-module-ul>li{
        float:left;margin-right: 20px;
    }
    .work-sheet-module-item{
        cursor:pointer;
    }
    .work-sheet-module-item-icon{
        width: 60px;height: 60px;border: 1px solid #1E9FFF;display: flex;
        justify-content: center; /*水平方向的居中*/
        align-items: center; /*垂直方向的居中*/
    }
    .work-sheet-module-item-icon>i{
        font-size: 30px; color: #1E9FFF;
    }
    .work-sheet-module-item-text{
        width:auto;text-align:center;margin-top:8px;
    }
</style>

<body>
<!-- 页面加载loading -->
<div class="page-loading">
    <div class="ball-loader">
        <span></span><span></span><span></span><span></span>
    </div>
</div>
<!-- 正文开始 -->

<div class="layui-fluid" style="margin-top: 20px;">
    <div class="layui-form toolbar">
        <div class="layui-form-item">
            <blockquote class="layui-elem-quote">
                <div class="layui-inline">
                    <label class="layui-form-label w-auto">创建时间：</label>
                    <div class="layui-input-inline">
                        <input type="text" class="layui-input" id="add_time_stateEnd" name="add_time" placeholder=" - ">
                    </div>
                </div>

                <div class="layui-inline" style="padding-right: 110px;">
                    <button class="layui-btn icon-btn table-search-btn" lay-filter="search" lay-submit>
                        <i class="layui-icon">&#xe615;</i>搜索
                    </button>
                </div>
            </blockquote>

            <table class="layui-table layui-text" style="width: 1200px">
                <tbody id="t_tbody">
                </tbody>
            </table>

        </div>

    </div>

</div>

<script>
    var lay_page = 1;
    var layui_obj = layui.config({
        version: true,
        base: '/assets/model/'
    }).extend({
        common: 'common/js/common',
    }).use(['common','jquery','form','laydate','xmSelect'], function () {
        var form = layui.form,
        laydate = layui.laydate;
        var $ = layui.jquery;
        var common = layui.common;
        //日期范围
        laydate.render({
            elem: '#add_time_stateEnd'
            ,range: true
        });

        getData();

        //监听搜索按钮
        form.on('submit(search)',function(data)
        {
            getData(data.field, true);
            return false;
        });



        function getData(requestData)
        {
            // layer.load(2);
            //工单系统页面信息
             common.req({
                url: "work_sheet/index",
                data: requestData,
                type: "post",
                dataType:"json",
                success:function(json){

                    layer.closeAll('loading');

                    if( json.code==0 ){

                        var tableStr = '';

                        $.each(json.data, function (i, t) {

                            tableStr += '<tr>\n' +
                                '            <td style="width: 80px"><b style="font-size: 1.1em">'+t.title+'</b></td>\n' +
                                '            <td style="width: 80px"><a class="layui-btn layui-btn-sm layui-btn-normal" onClick="new_page(this)" data-id="'+t.id+'" data-type="pendingNum" style="background-color: #1E9FFF">待处理</a></td>\n' +
                                '            <td>'+t.pendingNum+'</td>\n' +
                                '            <td style="width: 80px"><a class="layui-btn layui-btn-sm layui-btn-normal" onClick="new_page(this)" data-id="'+t.id+'" data-type="inProcessNum" style="background-color: #5FB878">处理中</a></td>\n' +
                                '            <td>'+t.inProcessNum+'</td>\n' +
                                '            <td style="width: 80px"><a class="layui-btn layui-btn-sm layui-btn-normal" onClick="new_page(this)" data-id="'+t.id+'" data-type="endNum" style="background-color: #009688">已结单</a></td>\n' +
                                '            <td>'+t.endNum+'</td>\n' +
                                '            <td style="width: 80px"><a class="layui-btn layui-btn-sm layui-btn-normal" onClick="new_page(this)" data-id="'+t.id+'" data-type="overtimeNum" style="background-color: #FF6347">超时</a></td>\n' +
                                '            <td>'+t.overtimeNum+'</td>\n' +
                                '            <td style="width: 80px"><a class="layui-btn layui-btn-sm layui-btn-normal" onClick="new_page(this)" data-id="'+t.id+'" data-type="addNum" style="background-color: #3c8dbc">新增</a></td>\n' +
                                '            <td>'+t.addNum+'</td>\n' +
                                '        </tr>';

                        });

                        $('#t_tbody').html(tableStr);
                        form.render();
                    }
                },
                error:function(data){
                    layer.alert('错误'+data.msg,{icon:2});
                }
            });
            common.isLoading(false);
        }

        window.new_page = function(e){
            var this_obj = $(e);
            var sheet_type = this_obj.attr('data-id');
            var static_type = this_obj.attr('data-type');
            var add_time = $('input[name=add_time]').val();
            var static_type_name = this_obj.html();
            
            var url = 'view/work_sheet/list.html?sheet_type='+sheet_type;
            url+='&static_type='+static_type;
            url+='&add_time='+add_time;

            window.parent.topTabsPageCreate({url:url,title:'工单列表-'+static_type_name,urlType:'',close:true});
            // App.fixIframeCotent();
        }

    });

    

</script>
</body>
</html>