{% include 'common/header_layui.volt' %}
<body class="hold-transition skin-blue sidebar-mini">
<form class="layui-form" action="" style="padding: 20px;">
    <input type="hidden" name="username" value="{{ username }}">
    <div class="layui-form-item">
        <label class="layui-form-label">原密码</label>
        <div class="layui-input-inline">
            <input type="password" name="oldpassword"  autocomplete="off" class="layui-input" placeholder="请输入原密码">
        </div>
    </div>
    <div class="layui-form-item">
        <label class="layui-form-label">新密码</label>
        <div class="layui-input-inline">
            <input type="password" name="password"  autocomplete="off" class="layui-input" placeholder="请输入新密码">
        </div>
    </div>
    <div class="layui-form-item">
        <label class="layui-form-label">新密码</label>
        <div class="layui-input-inline">
            <input type="password" name="repassword" lay-verify="required" autocomplete="off" class="layui-input" placeholder="请重复输入原密码">
        </div>
    </div>
    <div class="layui-form-item">
        <div class="layui-input-block">
            <button type="submit" class="layui-btn" lay-submit="" lay-filter="submit_btn">立即提交</button>
        </div>
    </div>
</form>

<script>
    layui.use(['form'], function(){
        var form = layui.form;
        //监听提交
        form.on('submit(submit_btn)', function(data){
            $.ajax({
                url: "/admin/admin/repassword_n",
                data: data.field,
                type: "post",
                dataType:"json",
                success:function(data){
                    if( data.status==1 ){
                        var index = parent.layer.getFrameIndex(window.name);
                        window.parent.res_msg(data.msg);
                        parent.layer.close(index);//关闭当前页
                        //window.parent.location.reload(); //刷新父窗口
                    }else{
                        layer.msg(data.msg,{icon:2});
                    }
                },
                error:function(data){
                    layer.alert('错误'+data.msg,{icon:2});
                }
            });
            return false;
        });
    });
</script>
</body>
</html>